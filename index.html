<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>✨ किराना ऑर्डर सिस्टम</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
/* Modern Color Scheme */
:root {
  --primary: #4caf50;
  --primary-dark: #388e3c;
  --primary-light: #c8e6c9;
  --accent: #ff9800;
  --accent-dark: #f57c00;
  --background: #f5f9f5;
  --card-bg: #ffffff;
  --text: #333333;
  --text-light: #666666;
  --discount: #e53935;
  --sidebar-bg: linear-gradient(135deg, #0f2027, #203a43, #2c5364);
  --glow-color: #4cc9f0;
  --glow-color-secondary: #f72585;
}

/* Modern Styles */
* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
  font-family: 'Segoe UI', 'Roboto', 'Noto Sans', sans-serif;
}

body {
  background: var(--background);
  color: var(--text);
  padding-bottom: 30px;
  line-height: 1.6;
  display: flex;
  min-height: 100vh;
  margin-left: 250px;
  transition: margin-left 0.3s;
  background: linear-gradient(135deg, #f5f7fa 0%, #e4edf5 100%);
}

/* Modern Sidebar Navigation with Glow Effects */
.sidebar {
  position: fixed;
  top: 0;
  left: 0;
  bottom: 0;
  width: 250px;
  background: var(--sidebar-bg);
  box-shadow: 0 0 25px rgba(76, 201, 240, 0.5);
  z-index: 1000;
  overflow-y: auto;
  padding: 20px 0;
  display: flex;
  flex-direction: column;
  border-right: 2px solid var(--glow-color);
  animation: sidebar-glow 3s infinite alternate;
}

@keyframes sidebar-glow {
  0% {
    box-shadow: 0 0 25px rgba(76, 201, 240, 0.5);
  }
  100% {
    box-shadow: 0 0 35px rgba(247, 37, 133, 0.6);
  }
}

.sidebar-header {
  padding: 20px;
  text-align: center;
  border-bottom: 1px solid rgba(255,255,255,0.1);
  margin-bottom: 15px;
}

.sidebar-header h1 {
  color: white;
  font-size: 1.8rem;
  text-shadow: 0 0 10px rgba(255,255,255,0.7);
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 10px;
  animation: text-glow 2s infinite alternate;
}

@keyframes text-glow {
  0% {
    text-shadow: 0 0 10px rgba(255,255,255,0.7);
  }
  100% {
    text-shadow: 0 0 15px var(--glow-color), 0 0 20px rgba(255,255,255,0.9);
  }
}

.sidebar-header h1 i {
  color: var(--accent);
  filter: drop-shadow(0 0 5px var(--glow-color));
}

.sidebar-nav {
  display: flex;
  flex-direction: column;
  flex-grow: 1;
}

.sidebar-nav a {
  padding: 15px 25px;
  font-weight: 600;
  color: rgba(255,255,255,0.9);
  text-decoration: none;
  display: flex;
  align-items: center;
  gap: 15px;
  transition: all 0.3s ease;
  border-left: 4px solid transparent;
  margin: 5px 0;
  font-size: 1.1rem;
  text-shadow: 0 0 5px rgba(255,255,255,0.5);
  position: relative;
  overflow: hidden;
  z-index: 1;
}

.sidebar-nav a::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
  transition: 0.5s;
  z-index: -1;
}

.sidebar-nav a:hover::before {
  left: 100%;
}

.sidebar-nav a:hover {
  background: rgba(255,255,255,0.1);
  color: white;
  border-left: 4px solid var(--glow-color);
  text-shadow: 0 0 10px var(--glow-color);
}

.sidebar-nav a.active {
  background: rgba(255,255,255,0.15);
  color: white;
  border-left: 4px solid var(--glow-color);
  text-shadow: 0 0 10px var(--glow-color);
  box-shadow: inset 0 0 15px rgba(76, 201, 240, 0.3);
}

.sidebar-nav .emoji {
  filter: drop-shadow(0 0 3px var(--glow-color));
  animation: emoji-glow 2s infinite alternate;
}

@keyframes emoji-glow {
  0% {
    filter: drop-shadow(0 0 3px var(--glow-color));
  }
  100% {
    filter: drop-shadow(0 0 6px var(--glow-color-secondary));
  }
}

.cart-summary-sidebar {
  background: rgba(255,255,255,0.1);
  border-radius: 10px;
  margin: 15px;
  padding: 15px;
  text-align: center;
  color: white;
  cursor: pointer;
  transition: all 0.3s;
  border: 1px solid rgba(76, 201, 240, 0.3);
  position: relative;
  overflow: hidden;
  box-shadow: 0 0 15px rgba(76, 201, 240, 0.3);
}

.cart-summary-sidebar::before {
  content: '';
  position: absolute;
  top: -50%;
  left: -50%;
  width: 200%;
  height: 200%;
  background: linear-gradient(transparent, rgba(76, 201, 240, 0.1), transparent);
  transform: rotate(30deg);
  animation: shine 3s infinite linear;
}

@keyframes shine {
  0% { transform: rotate(30deg) translate(-10%, -10%); }
  100% { transform: rotate(30deg) translate(90%, 90%); }
}

.cart-summary-sidebar:hover {
  background: rgba(255,255,255,0.2);
  box-shadow: 0 0 20px var(--glow-color);
}

.cart-summary-sidebar i {
  font-size: 1.5rem;
  margin-bottom: 10px;
  color: var(--accent);
  filter: drop-shadow(0 0 5px var(--glow-color));
}

#cartCount {
  font-size: 1.8rem;
  font-weight: bold;
  display: block;
  margin: 5px 0;
  color: var(--accent);
  text-shadow: 0 0 10px var(--glow-color);
}

#cartTotalSide {
  font-size: 1.3rem;
  font-weight: 600;
  display: block;
  text-shadow: 0 0 8px rgba(255,255,255,0.7);
}

.sidebar-footer {
  padding: 15px;
  text-align: center;
  color: rgba(255,255,255,0.6);
  font-size: 0.9rem;
  border-top: 1px solid rgba(255,255,255,0.1);
  text-shadow: 0 0 5px rgba(255,255,255,0.5);
}

/* Responsive sidebar */
@media (max-width: 768px) {
  body {
    margin-left: 0;
    flex-direction: column;
  }
  
  .sidebar {
    width: 100%;
    height: auto;
    padding: 0;
    position: relative;
  }
  
  .sidebar-nav {
    flex-direction: row;
    flex-wrap: wrap;
    padding: 0 10px;
  }
  
  .sidebar-nav a {
    padding: 10px 15px;
    border-left: none;
    border-bottom: 3px solid transparent;
    white-space: nowrap;
  }
  
  .sidebar-nav a:hover, 
  .sidebar-nav a.active {
    border-left: none;
    border-bottom: 3px solid var(--accent);
  }
  
  .cart-summary-sidebar {
    margin: 10px;
  }
}

/* Main Content */
.main-content {
  flex-grow: 1;
  padding: 20px;
}

/* Top Bar */
.top-bar {
  display: flex;
  justify-content: space-between;
  align-items: center;
  background: white;
  border-radius: 15px;
  box-shadow: 0 4px 20px rgba(0,0,0,0.1);
  padding: 15px 25px;
  margin-bottom: 25px;
  background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
  border: 1px solid #e0e0e0;
}

.top-bar h2 {
  margin: 0;
  color: var(--primary-dark);
  font-size: 1.8rem;
  text-shadow: 0 0 5px rgba(76, 175, 80, 0.3);
}

.search-container {
  display: flex;
  align-items: center;
  background: #f5f5f5;
  border-radius: 30px;
  padding: 8px 20px;
  width: 300px;
  box-shadow: inset 0 1px 3px rgba(0,0,0,0.1);
  border: 1px solid #e0e0e0;
}

.search-container input {
  background: transparent;
  border: none;
  color: var(--text);
  padding: 8px 12px;
  font-size: 1rem;
  width: 100%;
  outline: none;
}

.search-container button {
  background: transparent;
  border: none;
  color: var(--primary);
  font-size: 1.2rem;
  cursor: pointer;
  transition: all 0.3s;
}

.search-container button:hover {
  transform: scale(1.1);
  color: var(--primary-dark);
}

/* Form Styles */
.form-box {
  padding: 25px;
  background: var(--card-bg);
  margin: 20px 0;
  border-radius: 15px;
  box-shadow: 0 6px 18px rgba(0,0,0,0.08);
  background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
  border: 1px solid #e0e0e0;
}

.form-box h3 {
  display: flex;
  align-items: center;
  gap: 12px;
  font-size: 1.4rem;
  color: var(--primary-dark);
  margin-bottom: 20px;
  text-shadow: 0 0 5px rgba(76, 175, 80, 0.2);
}

.form-box input {
  width: 100%;
  padding: 14px 20px;
  margin: 12px 0;
  border: 1px solid #ddd;
  border-radius: 10px;
  font-size: 16px;
  transition: all 0.2s ease;
  background: #fafafa;
  box-shadow: inset 0 1px 3px rgba(0,0,0,0.05);
}

.form-box input:focus {
  border-color: var(--primary);
  box-shadow: 0 0 0 3px rgba(76, 175, 80, 0.2);
  outline: none;
}

/* Modern Grid Layout */
.grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
  gap: 25px;
}

/* Modern Card Design with Hover Effect */
.card {
  background: var(--card-bg);
  border-radius: 15px;
  box-shadow: 0 5px 20px rgba(0,0,0,0.1);
  text-align: center;
  padding-bottom: 20px;
  transition: all 0.3s ease;
  overflow: hidden;
  position: relative;
  border: 1px solid #e0e0e0;
  background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
}

.card:hover {
  transform: translateY(-8px);
  box-shadow: 0 12px 25px rgba(0,0,0,0.15);
}

.card .image-container {
  position: relative;
  height: 200px;
  overflow: hidden;
}

.card img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  transition: transform 0.5s ease;
}

.card:hover img {
  transform: scale(1.05);
}

.card h4 {
  margin: 15px 0 8px;
  font-size: 18px;
  font-weight: 600;
  color: var(--text);
  padding: 0 15px;
  text-shadow: 0 0 3px rgba(0,0,0,0.1);
}

.card .price-info {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 8px;
  margin: 10px 0;
}

.card .original-price {
  color: var(--text-light);
  text-decoration: line-through;
  font-size: 14px;
}

.card .discount-badge {
  background: var(--discount);
  color: white;
  font-size: 12px;
  font-weight: 600;
  padding: 3px 8px;
  border-radius: 15px;
  position: absolute;
  top: 15px;
  right: 15px;
  box-shadow: 0 3px 8px rgba(0,0,0,0.2);
  z-index: 2;
  text-shadow: 0 0 3px rgba(0,0,0,0.3);
}

.price-select, .qty-input, .discount-select {
  width: 100px;
  padding: 10px;
  margin: 8px 0;
  border: 1px solid #ddd;
  border-radius: 10px;
  text-align: center;
  background: #fafafa;
  font-size: 15px;
  transition: all 0.2s ease;
  box-shadow: inset 0 1px 3px rgba(0,0,0,0.05);
}

.price-select:focus, .qty-input:focus, .discount-select:focus {
  border-color: var(--primary);
  box-shadow: 0 0 0 3px rgba(76, 175, 80, 0.2);
  outline: none;
}

.discount-select {
  width: 80px;
  background: #fff8e1;
  border-color: #ffecb3;
}

.discount-label {
  display: block;
  font-size: 13px;
  color: var(--accent-dark);
  margin-top: 5px;
  font-weight: 500;
}

.qty-requirement {
  font-size: 12px;
  color: #f57c00;
  margin-top: 5px;
  font-weight: 500;
}

.btn {
  margin: 12px 10px 8px;
  padding: 10px 20px;
  border-radius: 30px;
  border: none;
  background: linear-gradient(to right, var(--primary), var(--primary-dark));
  color: white;
  cursor: pointer;
  font-weight: 600;
  transition: all 0.3s ease;
  box-shadow: 0 5px 12px rgba(76, 175, 80, 0.3);
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  font-size: 15px;
  text-shadow: 0 0 3px rgba(0,0,0,0.3);
}

.btn:hover {
  transform: translateY(-3px);
  box-shadow: 0 8px 15px rgba(76, 175, 80, 0.4);
  background: linear-gradient(to right, var(--primary-dark), var(--primary));
}

.btn:active {
  transform: translateY(0);
}

.btn i {
  font-size: 16px;
}

/* Cart Panel */
.cart-panel {
  position: fixed;
  top: 0;
  right: -400px;
  bottom: 0;
  width: 380px;
  background: white;
  box-shadow: -5px 0 25px rgba(0,0,0,0.15);
  z-index: 2000;
  transition: right 0.4s ease;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
  border-left: 1px solid #e0e0e0;
}

.cart-panel.open {
  right: 0;
}

.cart-header {
  background: linear-gradient(135deg, var(--primary), var(--primary-dark));
  color: white;
  padding: 20px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  text-shadow: 0 0 5px rgba(0,0,0,0.3);
}

.cart-header h3 {
  margin: 0;
  font-size: 1.5rem;
  display: flex;
  align-items: center;
  gap: 10px;
}

.close-cart {
  background: rgba(255,255,255,0.2);
  border: none;
  color: white;
  width: 40px;
  height: 40px;
  border-radius: 50%;
  font-size: 1.3rem;
  cursor: pointer;
  transition: all 0.3s;
}

.close-cart:hover {
  background: rgba(255,255,255,0.3);
  transform: rotate(90deg);
}

.cart-items {
  flex-grow: 1;
  overflow-y: auto;
  padding: 20px;
}

.cart-item {
  display: flex;
  padding: 15px 0;
  border-bottom: 1px solid #eee;
}

.cart-item-image {
  width: 80px;
  height: 80px;
  border-radius: 10px;
  overflow: hidden;
  margin-right: 15px;
  box-shadow: 0 3px 8px rgba(0,0,0,0.1);
}

.cart-item-image img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.cart-item-details {
  flex-grow: 1;
}

.cart-item-name {
  font-weight: 600;
  margin-bottom: 5px;
}

.cart-item-price {
  color: var(--primary-dark);
  font-weight: 600;
}

.cart-item-discount {
  color: var(--discount);
  font-size: 14px;
  margin-top: 3px;
}

.remove-btn {
  background: #f44336;
  color: white;
  border: none;
  padding: 5px 10px;
  border-radius: 6px;
  cursor: pointer;
  transition: all 0.2s ease;
  align-self: flex-start;
  box-shadow: 0 2px 5px rgba(0,0,0,0.1);
}

.remove-btn:hover {
  background: #d32f2f;
  transform: translateY(-2px);
}

.cart-footer {
  padding: 20px;
  border-top: 1px solid #eee;
  background: white;
  box-shadow: 0 -3px 10px rgba(0,0,0,0.05);
}

.cart-total-row {
  display: flex;
  justify-content: space-between;
  padding: 8px 0;
  font-size: 17px;
}

.cart-total-row.total {
  font-weight: bold;
  font-size: 20px;
  margin-top: 10px;
  padding-top: 15px;
  border-top: 2px dashed #eee;
}

.cart-total-label {
  color: var(--text-light);
}

.cart-total-value {
  color: var(--primary-dark);
  font-weight: 600;
}

.submit-btn {
  background: linear-gradient(to right, var(--accent), var(--accent-dark));
  color: white;
  border: none;
  padding: 16px;
  font-weight: 700;
  border-radius: 12px;
  cursor: pointer;
  font-size: 18px;
  transition: all 0.3s ease;
  margin-top: 15px;
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 10px;
  text-shadow: 0 0 3px rgba(0,0,0,0.3);
  box-shadow: 0 5px 15px rgba(255, 152, 0, 0.4);
}

.submit-btn:hover {
  transform: translateY(-3px);
  box-shadow: 0 8px 20px rgba(255, 152, 0, 0.5);
  background: linear-gradient(to right, var(--accent-dark), var(--accent));
}

/* Responsive Adjustments */
@media (max-width: 992px) {
  .grid {
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  }
  
  .card .image-container {
    height: 180px;
  }
}

@media (max-width: 768px) {
  .main-content {
    padding: 15px;
  }
  
  .top-bar {
    flex-direction: column;
    gap: 15px;
    padding: 15px;
  }
  
  .search-container {
    width: 100%;
  }
  
  .grid {
    grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
    gap: 20px;
  }
  
  .card .image-container {
    height: 150px;
  }
}

@media (max-width: 480px) {
  .grid {
    grid-template-columns: 1fr;
  }
  
  .cart-panel {
    width: 100%;
    right: -100%;
  }
  
  .card .image-container {
    height: 200px;
  }
}

/* Category emojis */
.emoji {
  font-size: 1.4em;
  vertical-align: middle;
}

/* Item limit badge */
.item-limit-badge {
  position: absolute;
  top: 15px;
  left: 15px;
  background: #ff5722;
  color: white;
  font-size: 12px;
  font-weight: 600;
  padding: 3px 10px;
  border-radius: 15px;
  box-shadow: 0 3px 8px rgba(0,0,0,0.2);
  z-index: 2;
  text-shadow: 0 0 3px rgba(0,0,0,0.3);
}

/* Overlay for cart panel */
.overlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0,0,0,0.5);
  z-index: 1500;
  opacity: 0;
  visibility: hidden;
  transition: all 0.3s ease;
}

.overlay.active {
  opacity: 1;
  visibility: visible;
}

/* Quantity Requirement Colors */
.qty-requirement.low { color: #f57c00; }
.qty-requirement.medium { color: #ff9800; }
.qty-requirement.high { color: #f44336; }

/* Floating Glow Effect */
.floating {
  animation: floating 3s ease-in-out infinite;
}

@keyframes floating {
  0% { transform: translateY(0); }
  50% { transform: translateY(-10px); }
  100% { transform: translateY(0); }
}
  /* === Scroll-to-Top Button === */
#scrollTopBtn {
  display: none;
  position: fixed;
  bottom: 40px;
  right: 20px;
  z-index: 999;
  background: var(--primary);
  color: #fff;
  border: none;
  padding: 12px 16px;
  font-size: 22px;
  border-radius: 50%;
  cursor: pointer;
  box-shadow: 0 0 12px rgba(0, 0, 0, 0.35);
  transition: opacity 0.4s, transform 0.3s;
}
#scrollTopBtn:hover {
  background: var(--primary-dark);
  transform: translateY(-3px);
}
</style>
</head>
<body>

<!-- Sidebar Navigation -->
  <button id="scrollTopBtn" onclick="scrollToTop()">⬆️</button>
<div class="sidebar">
  <div class="sidebar-header floating">
    <h1><i class="fas fa-store"></i> किराना स्टोर</h1>
  </div>
  
  <div class="cart-summary-sidebar" onclick="toggleCartPanel()">
    <i class="fas fa-shopping-cart"></i>
    <span id="cartCount">0</span>
    <span id="cartTotalSide">₹0</span>
  </div>
  
  <nav class="sidebar-nav" id="navBar">
    <!-- Navigation will be added by JS -->
  </nav>
  
  <div class="sidebar-footer">
    <p>© 2025 किराना ऑर्डर सिस्टम</p>
  </div>
</div>

<div class="main-content">
  <div class="top-bar">
    <h2><i class="fas fa-shopping-basket"></i> किराना ऑर्डर</h2>
    <div class="search-container">
      <input type="text" id="searchInput" placeholder="🔍 आइटम खोजें...">
      <button onclick="searchItems()"><i class="fas fa-search"></i></button>
    </div>
  </div>

  <div class="form-box">
    <h3><i class="fas fa-user"></i> कस्टमर डिटेल</h3>
    <input id="custName" placeholder="नाम">
    <input id="custMobile" placeholder="मोबाइल नंबर" type="tel">
    <input id="custAddr" placeholder="पूरा पता">
  </div>

  <div id="itemsWrap"></div>
</div>

<!-- Cart Panel -->
<div class="overlay" id="cartOverlay" onclick="toggleCartPanel()"></div>
<div class="cart-panel" id="cartPanel">
  <div class="cart-header">
    <h3><i class="fas fa-shopping-cart"></i> आपका कार्ट</h3>
    <button class="close-cart" onclick="toggleCartPanel()">×</button>
  </div>
  
  <div class="cart-items" id="cartItems">
    <!-- Cart items will be added by JS -->
  </div>
  
  <div class="cart-footer">
    <div class="cart-total-row">
      <span class="cart-total-label">उप-योग:</span>
      <span class="cart-total-value" id="cartSubtotal">₹0</span>
    </div>
    <div class="cart-total-row">
      <span class="cart-total-label">छूट:</span>
      <span class="cart-total-value" id="cartDiscount">-₹0</span>
    </div>
    <div class="cart-total-row total">
      <span class="cart-total-label">कुल राशि:</span>
      <span class="cart-total-value" id="cartTotal">₹0</span>
    </div>
    
    <button class="submit-btn" onclick="submitOrder()">
      <i class="fas fa-paper-plane"></i> ऑर्डर सबमिट करें
    </button>
  </div>
</div>

<script>
/* ===== CONFIG ===== */
const waNumber='916351598832';
const tgToken ='7729928604:AAEINikbhwHTMSK1pgV3nROUfSGEVb-z2r4';
const tgChatId='6798434092';
const minOrder=100;

/* Emoji map for categories */
const categoryEmojis = {
  'पान मसाला': '🗣️',
  'बिस्किट': '🍪',
  'तेल': '🛢️',
  'साबुन / शैंपू': '🧴',
  'चावल और आटा': '🍚',
  'दालें': '🥣',
  'मसाले': '🌶️',
  'डेयरी': '🥛',
  'चाय / कॉफी': '☕',
  'पेय': '🥤',
  'स्नैक्स': '🍿',
  'फल': '🍎',
  'सब्जियां': '🥦',
  'बेकरी': '🍞'
};

/* ===== IMAGE MAP ===== */
const imgMap={
  'Kamla Pasand (₹3-₹5)':'https://i.postimg.cc/vHStXKT2/IMG-20250715-105207-104.jpg',
  'Rajnigandha (₹5+)':'https://i.postimg.cc/T3ZD3n7J/rajnigandha.jpg',
  'Kesar Pan Masala (₹3-5)':'https://i.postimg.cc/3NtH0hKZ/IMG-20250715-105303-784.jpg',
  'Signature (₹5+)':'https://i.postimg.cc/8zRT1TqF/signature.jpg',
  'SNK (₹3-5)': 'https://i.postimg.cc/bJYCDtdK/IMG-20250715-105229-011.jpg',
  'Baba Elaichi (₹1-5)':'https://i.postimg.cc/6QH3P2NJ/baba-elaichi.jpg',
  'Sweet Supari (₹1-₹5)':'https://i.postimg.cc/3wV5kCgB/sweet-supari.jpg',
  'Pass Pass (₹5)':'https://i.postimg.cc/3R6pPYnB/passpass.jpg',
  'rajshari (₹5-₹10)':'https://i.postimg.cc/4xCsw6kY/images.jpg',
  'vimal(₹5)':'https://i.postimg.cc/sf9Nb5hB/images-1.jpg',
  'Parle-G (₹5-₹10)':'https://i.postimg.cc/C1CcTVzy/Parle-G-Case-Study-Startup-Talky.jpg',
  'Good Day (₹2-₹3)':'https://i.postimg.cc/GmBz3DHx/1685796451556-SKU-0044-0.webp',
  'Hide & Seek (₹3-₹4)':'',
  'Marie (₹4-₹5)':'https://images.unsplash.com/photo-1599490659213-e2b2087a39f8?crop=entropy&cs=tinysrgb&fit=crop&fm=jpg&h=400&w=400',
  'Refined Oil (₹5+)':'https://images.unsplash.com/photo-1612927601601-6638404737ce?crop=entropy&cs=tinysrgb&fit=crop&fm=jpg&h=400&w=400',
  'Lifebuoy (₹1-₹2)':'https://images.unsplash.com/photo-1608571425051-7c3c29d0e26d?crop=entropy&cs=tinysrgb&fit=crop&fm=jpg&h=400&w=400',
  'Lux (₹2-₹3)':'https://images.unsplash.com/photo-1595425970375-0df41da6d0c5?crop=entropy&cs=tinysrgb&fit=crop&fm=jpg&h=400&w=400',
  'Clinic Plus (₹3-₹4)':'https://images.unsplash.com/photo-1590155989070-022e8fca8d8b?crop=entropy&cs=tinysrgb&fit=crop&fm=jpg&h=400&w=400',
  'Head & Shoulders (₹4-₹5)':'https://images.unsplash.com/photo-1625772299848-391b6a87d7b3?crop=entropy&cs=tinysrgb&fit=crop&fm=jpg&h=400&w=400',
  'Mustard Oil (₹5+)':'https://images.unsplash.com/photo-1612927601601-6638404737ce?crop=entropy&cs=tinysrgb&fit=crop&fm=jpg&h=400&w=400',
  'Groundnut Oil (₹5+)':'https://images.unsplash.com/photo-1612927601601-6638404737ce?crop=entropy&cs=tinysrgb&fit=crop&fm=jpg&h=400&w=400',
  'Soyabean Oil (₹5+)':'https://images.unsplash.com/photo-1612927601601-6638404737ce?crop=entropy&cs=tinysrgb&fit=crop&fm=jpg&h=400&w=400',
  'Basmati Rice (₹5+)':'https://images.unsplash.com/photo-1543253687-c931c8e01820?crop=entropy&cs=tinysrgb&fit=crop&fm=jpg&h=400&w=400',
  'Wheat Flour (₹5+)':'https://images.unsplash.com/photo-1602922960040-2f8a5a4d0b3d?crop=entropy&cs=tinysrgb&fit=crop&fm=jpg&h=400&w=400',
  'Sona Masoori (₹5+)':'https://images.unsplash.com/photo-1543253687-c931c8e01820?crop=entropy&cs=tinysrgb&fit=crop&fm=jpg&h=400&w=400',
  'Moong Dal (₹5+)':'https://images.unsplash.com/photo-1594212699903-ec8a3eca50f5?crop=entropy&cs=tinysrgb&fit=crop&fm=jpg&h=400&w=400',
  'Masoor Dal (₹5+)':'https://images.unsplash.com/photo-1594212699903-ec8a3eca50f5?crop=entropy&cs=tinysrgb&fit=crop&fm=jpg&h=400&w=400',
  'Chana Dal (₹5+)':'https://images.unsplash.com/photo-1594212699903-ec8a3eca50f5?crop=entropy&cs=tinysrgb&fit=crop&fm=jpg&h=400&w=400',
  'Turmeric Powder (₹5+)':'https://images.unsplash.com/photo-1575939238474-c8ada13b2724?crop=entropy&cs=tinysrgb&fit=crop&fm=jpg&h=400&w=400',
  'Coriander Powder (₹5+)':'https://images.unsplash.com/photo-1605276373954-0c4a0dac5b12?crop=entropy&cs=tinysrgb&fit=crop&fm=jpg&h=400&w=400',
  'Red Chilli Powder (₹5+)':'https://images.unsplash.com/photo-1594212699903-ec8a3eca50f5?crop=entropy&cs=tinysrgb&fit=crop&fm=jpg&h=400&w=400'
};
const defaultImg='https://i.postimg.cc/fyChfP4G/file-000000000d4461f685608b28ed0f721b.jpg';

/* ===== DATA (प्राइस वैरिएंट और डिस्काउंट के साथ) ===== */
const data={
'पान मसाला':[
  {name:'rajshari (₹5-₹10)', prices:[5,10,20,40], discount: 0, minQty: 1},
  {name:'Kamla Pasand (₹3-5)', prices:[3,5], discount:0, minQty:3},
  {name:'Rajnigandha (₹5)', prices:[10], discount:0, minQty:1},
  {name:'Kesar Pan Masala (₹3-5)', prices:[3,5], discount:0, minQty:4},
  {name:'Signature (₹5)', prices:[10], discount:0, minQty:1},
  {name:'SNK (₹3-5)', prices:[3,5], discount:0, minQty:4},
  {name:'Baba Elaichi (₹1-₹5)', prices:[1,5], discount:0, minQty:5},
  {name:'Sweet Supari (₹1-₹5)', prices:[1,5], discount:0, minQty:5},
  {name:'Pass Pass (₹5)', prices:[5], discount:0, minQty:1},
  {name:'viaml (₹5+)', prices:[5,10], discount: 0, minQty: 1}
],
'बिस्किट':[
  {name:'Parle-G (₹5-₹10)', prices:[10,20], discount: 0, minQty: 1},
  {name:'Good Day (₹2-₹3)', prices:[2,3], discount: 15, minQty: 5},
  {name:'Hide & Seek (₹3-₹4)', prices:[3,4], discount: 5, minQty: 3},
  {name:'Marie (₹4-₹5)', prices:[4,5], discount: 20, minQty: 2}
],
'तेल':[
  {name:'Refined Oil (₹5+)', prices:[50,100], discount: 7, minQty: 1},
  {name:'Mustard Oil (₹5+)', prices:[50,120], discount: 12, minQty: 1},
  {name:'Groundnut Oil (₹5+)', prices:[60,120], discount: 8, minQty: 1},
  {name:'Soyabean Oil (₹5+)', prices:[50,110], discount: 5, minQty: 1}
],
'साबुन / शैंपू':[
  {name:'Lifebuoy (₹1-₹2)', prices:[1,2], discount: 10, minQty: 10},
  {name:'Lux (₹2-₹3)', prices:[2,3], discount: 15, minQty: 5},
  {name:'Clinic Plus (₹3-₹4)', prices:[3,4], discount: 20, minQty: 3},
  {name:'Head & Shoulders (₹4-₹5)', prices:[4,5], discount: 25, minQty: 2}
],
'चावल और आटा':[
  {name:'Basmati Rice (₹5+)', prices:[80,160], discount: 8, minQty: 1},
  {name:'Wheat Flour (₹5+)', prices:[40,80], discount: 10, minQty: 1},
  {name:'Sona Masoori (₹5+)', prices:[70,140], discount: 5, minQty: 1}
],
'दालें':[
  {name:'Moong Dal (₹5+)', prices:[90,180], discount: 7, minQty: 1},
  {name:'Masoor Dal (₹5+)', prices:[80,160], discount: 10, minQty: 1},
  {name:'Chana Dal (₹5+)', prices:[85,170], discount: 5, minQty: 1}
],
'मसाले':[
  {name:'Turmeric Powder (₹5+)', prices:[20,40,100], discount: 10, minQty: 1},
  {name:'Coriander Powder (₹5+)', prices:[25,50,120], discount: 15, minQty: 1},
  {name:'Red Chilli Powder (₹5+)', prices:[30,60,150], discount: 12, minQty: 1}
]
};

/* ===== BUILD HTML ===== */
const nav=document.getElementById('navBar');
const wrap=document.getElementById('itemsWrap');
let id=1;

// Add categories to navbar
Object.keys(data).forEach((cat, idx) => {
  const emoji = categoryEmojis[cat] || '🛒';
  nav.innerHTML += `
    <a href="#sec${idx+1}" class="${idx === 0 ? 'active' : ''}">
      <span class="emoji">${emoji}</span> ${cat}
    </a>`;
});

// Add sections for each category
Object.entries(data).forEach(([cat, items], idx) => {
  const emoji = categoryEmojis[cat] || '🛒';
  let sec = `<section id="sec${idx+1}"><h2><span class="emoji">${emoji}</span> ${cat}</h2><div class="grid">`;
  
  items.forEach(it => {
    const img = imgMap[it.name] || defaultImg;
    const discount = it.discount || 0;
    const minQty = it.minQty || 1;
    
    // Determine requirement class based on minQty
    let qtyClass = '';
    if (minQty >= 10) qtyClass = 'high';
    else if (minQty >= 5) qtyClass = 'medium';
    else if (minQty >= 3) qtyClass = 'low';
    
    sec += `<div class="card">
      ${discount > 0 ? `<div class="discount-badge">${discount}% OFF</div>` : ''}
      <div class="image-container">
        <img src="${img}" alt="${it.name}">
      </div>
      <h4>${it.name}</h4>`;
    
    if (discount > 0) {
      const originalPrice = it.prices[0];
      const discountedPrice = originalPrice * (1 - discount/100);
      sec += `<div class="price-info">
                <span class="original-price">₹${originalPrice}</span>
                <span class="discount-price">₹${discountedPrice.toFixed(2)}</span>
              </div>`;
    } else {
      sec += `<div class="price-info">₹${it.prices[0]}</div>`;
    }
    
    sec += `<select id="p${id}" class="price-select">
        ${it.prices.map(v => `<option value="${v}">₹${v}</option>`).join('')}
      </select>
      <input id="q${id}" type="number" class="qty-input" placeholder="मात्रा" min="${minQty}" value="${minQty}">
      
      <div class="qty-requirement ${qtyClass}">न्यूनतम मात्रा: ${minQty}</div>
      
      ${discount > 0 ? `<div class="discount-label">${discount}% छूट लागू</div>` : ''}
      
      <button class="btn" onclick="add('${it.name}',parseInt(p${id}.value),'unit',q${id}.value, ${discount}, ${minQty}, '${img}')">
        <i class="fas fa-cart-plus"></i> जोड़ें
      </button>
    </div>`;
    id++;
  });
  
  sec += '</div></section>';
  wrap.innerHTML += sec;
});

/* ===== CART LOGIC ===== */
let cart = [];

function toggleCartPanel() {
  const panel = document.getElementById('cartPanel');
  const overlay = document.getElementById('cartOverlay');
  panel.classList.toggle('open');
  overlay.classList.toggle('active');
}

function add(name, price, unit, qty, discount=0, minQty=1, image) {
  qty = parseFloat(qty);
  
  // Validate minimum quantity
  if(qty < minQty) {
    alert(`❌ ${name} की न्यूनतम मात्रा ${minQty} है। कृपया ${minQty} या अधिक मात्रा में जोड़ें।`);
    return;
  }
  
  // Calculate discount
  let discountedPrice = price;
  if(discount > 0) {
    discountedPrice = price * (1 - discount/100);
  }
  
  const totalPrice = discountedPrice * qty;
  
  // Check if item already in cart
  const existingItem = cart.find(item => item.name === name && item.price === price);
  if(existingItem) {
    existingItem.qty += qty;
    existingItem.totalPrice += totalPrice;
    existingItem.discountApplied += (price - discountedPrice) * qty;
  } else {
    cart.push({
      name: name,
      price: price,
      qty: qty,
      discount: discount,
      discountedPrice: discountedPrice,
      totalPrice: totalPrice,
      discountApplied: (price - discountedPrice) * qty,
      minQty: minQty,
      image: image
    });
  }
  
  updateCart();
  
  // Show the cart panel
  toggleCartPanel();
}

function updateCart() {
  const totalItems = cart.reduce((sum, item) => sum + item.qty, 0);
  const subtotal = cart.reduce((sum, item) => sum + (item.price * item.qty), 0);
  const total = cart.reduce((sum, item) => sum + item.totalPrice, 0);
  const discountTotal = cart.reduce((sum, item) => sum + item.discountApplied, 0);
  
  // Update sidebar cart summary
  document.getElementById('cartCount').textContent = totalItems;
  document.getElementById('cartTotalSide').textContent = `₹${total.toFixed(2)}`;
  
  // Update cart panel
  const cartItems = document.getElementById('cartItems');
  cartItems.innerHTML = '';
  
  if(cart.length === 0) {
    cartItems.innerHTML = '<div style="text-align:center; padding:40px 20px; color:#888;">आपका कार्ट खाली है</div>';
    document.getElementById('cartSubtotal').textContent = '₹0';
    document.getElementById('cartDiscount').textContent = '-₹0';
    document.getElementById('cartTotal').textContent = '₹0';
    return;
  }
  
  cart.forEach((item, index) => {
    const cartItem = document.createElement('div');
    cartItem.className = 'cart-item';
    cartItem.innerHTML = `
      <div class="cart-item-image">
        <img src="${item.image}" alt="${item.name}">
      </div>
      <div class="cart-item-details">
        <div class="cart-item-name">${item.name} (${item.qty})</div>
        <div class="cart-item-price">₹${item.totalPrice.toFixed(2)}</div>
        ${item.discount > 0 ? `<div class="cart-item-discount">${item.discount}% छूट</div>` : ''}
        <div class="cart-item-discount">न्यूनतम: ${item.minQty}</div>
      </div>
      <button class="remove-btn" onclick="removeItem(${index})">
        <i class="fas fa-trash"></i>
      </button>
    `;
    cartItems.appendChild(cartItem);
  });
  
  // Update cart totals
  document.getElementById('cartSubtotal').textContent = `₹${subtotal.toFixed(2)}`;
  document.getElementById('cartDiscount').textContent = `-₹${discountTotal.toFixed(2)}`;
  document.getElementById('cartTotal').textContent = `₹${total.toFixed(2)}`;
}

function removeItem(index) {
  cart.splice(index, 1);
  updateCart();
}

function submitOrder() {
  if(!cart.length) {
    alert('🛒 कृपया ऑर्डर देने के लिए कम से कम एक आइटम जोड़ें!');
    return;
  }
  
  const total = cart.reduce((sum, item) => sum + item.totalPrice, 0);
  if(total < minOrder) {
    alert(`❌ न्यूनतम ऑर्डर राशि ₹${minOrder} है। आपका कुल: ₹${total.toFixed(2)}`);
    return;
  }
  
  const nm = document.getElementById('custName').value || 'N/A';
  const mb = document.getElementById('custMobile').value || 'N/A';
  const ad = document.getElementById('custAddr').value || 'N/A';
  
  if(nm === 'N/A' || mb === 'N/A' || ad === 'N/A') {
    alert('कृपया अपना नाम, मोबाइल नंबर और पूरा पता भरें!');
    return;
  }
  
  navigator.geolocation.getCurrentPosition(
    pos => sendOrder(nm, mb, ad, pos.coords.latitude, pos.coords.longitude, total),
    () => sendOrder(nm, mb, ad, null, null, total)
  );
}

function sendOrder(nm, mb, ad, lat, lon, total) {
  let msg = '🛍️ *नया किराना ऑर्डर!*\n\n';
  msg += '*आइटम:*\n';
  
  cart.forEach(item => {
    msg += `• ${item.name} (${item.qty}) - ₹${item.totalPrice.toFixed(2)}`;
    if(item.discount > 0) {
      msg += ` (${item.discount}% छूट)`;
    }
    msg += '\n';
  });
  
  const discountTotal = cart.reduce((sum, item) => sum + item.discountApplied, 0);
  if(discountTotal > 0) {
    msg += `\n*कुल छूट:* -₹${discountTotal.toFixed(2)}\n`;
  }
  
  msg += `\n💰 *कुल राशि: ₹${total.toFixed(2)}*\n`;
  msg += `👤 *ग्राहक:* ${nm}\n📞 ${mb}\n🏠 ${ad}`;
  
  if(lat && lon) {
    msg += `\n📍 https://www.google.com/maps?q=${lat},${lon}`;
  }
  
  // Send via WhatsApp
  window.open(`https://wa.me/${waNumber}?text=${encodeURIComponent(msg)}`, '_blank');
  
  // Send via Telegram
  fetch(`https://api.telegram.org/bot${tgToken}/sendMessage`, {
    method: 'POST',
    headers: {'Content-Type': 'application/json'},
    body: JSON.stringify({
      chat_id: tgChatId,
      text: msg,
      parse_mode: 'Markdown'
    })
  })
  .then(r => r.json())
  .then(d => {
    if(d.ok) {
      alert('✅ ऑर्डर सफलतापूर्वक सबमिट हो गया!');
      cart = [];
      updateCart();
      toggleCartPanel();
    } else {
      alert('❌ टेलीग्राम पर ऑर्डर भेजने में त्रुटि। कृपया व्हाट्सएप से ऑर्डर करें।');
    }
  })
  .catch(e => {
    console.error(e);
    alert('❌ टेलीग्राम पर ऑर्डर भेजने में त्रुटि। कृपया व्हाट्सएप से ऑर्डर करें।');
  });
}

// Search functionality
function searchItems() {
  const searchTerm = document.getElementById('searchInput').value.toLowerCase();
  if(!searchTerm) return;
  
  // Highlight all matching items
  const items = document.querySelectorAll('.card');
  let found = false;
  
  items.forEach(item => {
    const itemName = item.querySelector('h4').textContent.toLowerCase();
    if(itemName.includes(searchTerm)) {
      item.style.boxShadow = '0 0 0 3px #ff9800';
      setTimeout(() => {
        item.style.boxShadow = '';
      }, 3000);
      
      // Scroll to the item
      if(!found) {
        item.scrollIntoView({behavior: 'smooth', block: 'center'});
        found = true;
      }
    }
  });
  
  if(!found) {
    alert('कोई मिलता-जुलता आइटम नहीं मिला');
  }
}

// Search on enter key
document.getElementById('searchInput').addEventListener('keyup', function(e) {
  if(e.key === 'Enter') {
    searchItems();
  }
});

// Initialize page

  updateCart();

  // Add smooth scrolling for navigation links
  document.querySelectorAll('.sidebar-nav a').forEach(anchor => {
    anchor.addEventListener('click', function (e) {
      e.preventDefault();

      // Remove active class from all links
      document.querySelectorAll('.sidebar-nav a').forEach(link => {
        link.classList.remove('active');
      });

      // Add active class to clicked link
      this.classList.add('active');

      const target = document.querySelector(this.getAttribute('href'));
      if (target) {
        window.scrollTo({
          top: target.offsetTop - 100,
          behavior: 'smooth'
        });
      }
    });
  });

  /* ===== Scroll-to-Top Logic ===== */
  const scrollTopBtn = document.getElementById('scrollTopBtn');

  // स्क्रोल पर बटन दिखाओ / छिपाओ
  window.addEventListener('scroll', () => {
    scrollTopBtn.style.display =
      (document.documentElement.scrollTop > 120) ? 'block' : 'none';
  });

  // बटन क्लिक पर स्मूद-स्क्रोल सबसे ऊपर
  function scrollToTop() {
    window.scrollTo({ top: 0, behavior: 'smooth' });
  }
</script>
</body>
</html>
